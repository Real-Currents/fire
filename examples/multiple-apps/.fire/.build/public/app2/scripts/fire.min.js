"use strict";function _getUUID(a){var b;if("undefined"!=typeof a.toQueryValue)b=a.toQueryValue();else{if("string"!=typeof a){var c=new FireError("Parameter `"+a+"` is not a valid model instance or UUID.");throw c.status=400,c}b=a}return b}function transformQueryMap(a,b){var c={};return Object.keys(a||{}).forEach(function(b){var d=a[b];c[b]=d&&"undefined"!=typeof d.toQueryValue?d.toQueryValue():d}),b&&(c.$options=b),c}function FireError(a){this.name="FireError",this.message=a||"",this.number=-1}function unwrap(a,b){var c=b;return a.then(function(a){angular.copy(a,c)}),c}var app=angular.module("app2",["ngRoute"]);app.controller("TestController",[function(){}]),FireError.prototype=new Error,app.factory("_djb2Hash",function(){return function(a){for(var b=5381,c=0,d=0,e=a.length;e>d;d++)c=a.charCodeAt(d),b=33*b+c;return Math.abs(b)%(Math.pow(2,52)-1)}}),app.service("_CacheService",["$injector",function(a){function b(){if(window.localStorage)try{window.localStorage.setItem(h,JSON.stringify({objects:i,keys:j,indices:k}))}catch(a){}}function c(a){j.splice(j.indexOf(a),1),j.push(a)}function d(a){var b=a.indexOf(".");if(-1!=b){var c=a.substring(0,b),d=a.substring(b+1);return[c,d]}return[]}function e(a){var b=d(a);if(b.length){var c=b[0],e=b[1];if("undefined"==typeof k[c])return k[c]=[e],!0;if(-1==k[c].indexOf(e))return k[c].push(e),!0}return!1}function f(a){var b=d(a);if(b.length){var c=b[0],e=b[1];if("undefined"!=typeof k[c]){if("*"==e)return k[c].forEach(function(a){var b=c+"."+a;delete i[b];var d=j.indexOf(b);-1!=d&&j.splice(d,1)}),delete k[c],!0;var f=k[c].indexOf(e);-1!=f&&k[c].splice(f,1)}}return!1}var g=25,h="_CacheService",i={},j=[],k={};if(this.numberOfCaches=function(){return j.length},window.localStorage){var l=window.localStorage.getItem(h);if(l)try{var m=JSON.parse(l);m&&m.objects&&m.keys&&m.indices&&(i=m.objects,j=m.keys,k=m.indices)}catch(n){window.localStorage.setItem(h,null)}}this.remove=function(a){f(a)||"undefined"!=typeof i[a]&&(delete i[a],j.splice(j.indexOf(a),1))},this.removeAll=function(){i={},j=[],k={},b()},this.get=function(b,d){var e=i[b];if("undefined"!=typeof i[b]&&("undefined"==typeof d||-1==d||(new Date).getTime()-e.time<d)){if(c(b),e.value&&e.value._map&&e.value._map._type){var f=a.get("FireModelInstance"+e.value._map._type);e.value=new f(e.value._map,e.value._path)}return e.value}return null},this.put=function(a,c,d){if("undefined"!=typeof d&&(-1==d||d>0)){if(j.length>g){var h=j.splice(0,j.length-g);h.forEach(function(a){f(a),i[a]=null})}e(a)&&j.push(a),i[a]={value:c,time:(new Date).getTime()},b()}},this.persist=function(){b()}}]),app.factory("FireModel",["$http","$q","$injector","_CacheService","_djb2Hash",function(a,b,c,d,e){return function(f,g,h){this.name=f,this.autoFetchedAssociationNames=g,this.endpoint=h;var i=this;this.parse=function(a){return this.parseResult(a,null)},this.purge=function(){if(d.numberOfCaches()>0){var a=[],b=function(e){if(-1==a.indexOf(e)){a.push(e);var f=c.get(e+"Model");d.remove(f.name+".*",!1),f.autoFetchedAssociationNames.forEach(function(a){b(a)})}};b(this.name),d.persist()}},this["new"]=function(){var a=c.get("FireModelInstance"+this.name);return new a(null,this.endpoint)},this.parseResult=function(a,b){function d(a){var d;return new(d=c.get(a._type?"FireModelInstance"+a._type:"FireModelInstance"+i.name))(a,b)}return"[object Array]"===Object.prototype.toString.call(a)?a.map(d):d(a)},this._prepare=function(a){var b=function(a){var b={};return Object.keys(a||{}).forEach(function(c){b[c]=JSON.stringify(a[c])}),b};return Array.isArray(a)?a.map(b):b(a)},this._action=function(c,d,e,f){var g=b.defer();return a({method:c,url:d,data:f,params:e,headers:{"x-json-params":!0,"Content-Type":"application/json;charset=utf-8"}}).success(function(a){"get"!=c&&i.purge(),g.resolve(i.parseResult(a,d))}).error(function(a,b){var c=new FireError(a);c.number=b,g.reject(c)}),g.promise},this._delete=function(a,b){return this._action("delete",a,null,this._prepare(b))},this._post=function(a,b){return this._action("post",a,null,this._prepare(b))},this._get=function(a,c){var f=this.name+"."+e(a+(Object.keys(c||{}).length>0?JSON.stringify(c):"")),g=d.get(f,c.$options&&c.$options.cache);return!g||c.$options&&"undefined"!=typeof c.$options.returnCache&&!c.$options.returnCache?this._action("get",a,this._prepare(c)).then(function(a){return d.put(f,a,c.$options&&c.$options.cache),a}):(c.$options&&c.$options.autoReload&&(c.$options.returnCache=!1,delete c.$options.autoReload,this._get(a,c).then(function(a){Array.isArray(g)?g.forEach(function(b,c){c<a.length&&b.refresh(a[c])}):g.refresh(a)})),b.when(g))},this._put=function(a,b,c){return this._action("put",a,this._prepare(c),this._prepare(b))},this.update=function(a,b){return"object"==typeof a?this._put(this.endpoint,transformQueryMap(b),transformQueryMap(a)):this._put(this.endpoint+"/"+a,transformQueryMap(b))},this.remove=function(a,b){var c=null;return"undefined"!=typeof a.toQueryValue?c=a.toQueryValue():"string"==typeof a&&(c=a),c?this._action("delete",this.endpoint+"/"+c):this._action("delete",this.endpoint,this._prepare(transformQueryMap(a,b)))},this.updateOrCreate=function(a,b){return this.update(a,b).then(function(c){if(c.length)return c[0];var d={};return Object.keys(a||{}).forEach(function(b){d[b]=a[b]}),Object.keys(b||{}).forEach(function(a){d[a]=b[a]}),i.create(d)})},this.findOrCreate=function(a,b){return this.findOne(a).then(function(c){if(c)return c;var d={};return Object.keys(a||{}).forEach(function(b){d[b]=a[b]}),Object.keys(b||{}).forEach(function(a){d[a]=b[a]}),i.create(d)})},this._create=function(a,b){return Array.isArray(b)?this._post(a,b.map(function(a){return transformQueryMap(a)})):this._post(a,transformQueryMap(b))},this.create=function(a){return this._create(this.endpoint,a)},this._find=function(a,b,c){var d=transformQueryMap(b,c);return this._get(a,d)},this.find=function(a,b){return this._find(this.endpoint,a,b)},this.findOne=function(a,b){var c=a||{};if(c.id){var d=c.id;return delete c.id,this._get(this.endpoint+"/"+d,transformQueryMap(c,b)).then(function(a){return a&&(a._endpoint=i.endpoint+"/"+d),a})}var e=b||{};return e.limit=1,this.find(c,e).then(function(a){return a&&a.length?a[0]:null})},this.getOne=function(a){var c=b.defer();return this.findOne(a).then(function(a){if(a)c.resolve(a);else{var b=new FireError("Not Found");b.number=404,c.reject(b)}}),c.promise}}}]),app.factory("SharedModel",["$http","$q","FireModel","$injector","$route","$routeParams","$location",function(a,b,c){var d=new c("Shared",[],"/api/shareds");return d}]),app.factory("FireModelInstanceShared",["SharedModel","$q","$http","$injector",function(a,b){return function(c,d,e){if(e)throw new Error("FireModelInstanceShared only accepts two arguments now.");this._map=c||null,this._changes={},this.toJSON=function(){return{_map:this._map,_path:d}},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null;var f=this;Object.defineProperty(this,"id",{get:function(){return"undefined"!=typeof f._changes.id?f._changes.id:f._map.id},set:function(a){f._changes.id=a}}),Object.defineProperty(this,"name",{get:function(){return"undefined"!=typeof f._changes.name?f._changes.name:f._map.name},set:function(a){f._changes.name=a}}),this.cancel=function(){this._changes={}},this.refresh=function(b){return this._map=b._map,this._changes={},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null,this},this.toQueryValue=function(){return this._map.id},this.remove=function(){return a.remove(this._map.id)},this.save=function(){if(null===this._map)return a.create(this._changes).then(function(a){return f.refresh(a)});var c=Object.keys(this._changes).length;if(c){var d=transformQueryMap(this._changes);return a._put(this._endpoint,d).then(function(a){return f._changes={},Object.keys(a._map).forEach(function(b){null!==a._map[b]&&(f._map[b]=a._map[b])}),f})}return b.when(this)}}}]),app.factory("UserInApp2Model",["$http","$q","FireModel","$injector","$route","$routeParams","$location",function(a,b,c){var d=new c("UserInApp2",[],"/api/user-in-app2s");return d}]),app.factory("FireModelInstanceUserInApp2",["UserInApp2Model","$q","$http","$injector",function(a,b){return function(c,d,e){if(e)throw new Error("FireModelInstanceUserInApp2 only accepts two arguments now.");this._map=c||null,this._changes={},this.toJSON=function(){return{_map:this._map,_path:d}},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null;var f=this;Object.defineProperty(this,"id",{get:function(){return"undefined"!=typeof f._changes.id?f._changes.id:f._map.id},set:function(a){f._changes.id=a}}),Object.defineProperty(this,"name",{get:function(){return"undefined"!=typeof f._changes.name?f._changes.name:f._map.name},set:function(a){f._changes.name=a}}),this.cancel=function(){this._changes={}},this.refresh=function(b){return this._map=b._map,this._changes={},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null,this},this.toQueryValue=function(){return this._map.id},this.remove=function(){return a.remove(this._map.id)},this.save=function(){if(null===this._map)return a.create(this._changes).then(function(a){return f.refresh(a)});var c=Object.keys(this._changes).length;if(c){var d=transformQueryMap(this._changes);return a._put(this._endpoint,d).then(function(a){return f._changes={},Object.keys(a._map).forEach(function(b){null!==a._map[b]&&(f._map[b]=a._map[b])}),f})}return b.when(this)}}}]),app.factory("TestModel",["$http","$q","FireModel","$injector","$route","$routeParams","$location",function(a,b,c){var d=new c("Test",[],"/api/tests");return d}]),app.factory("FireModelInstanceTest",["TestModel","$q","$http","$injector",function(a,b,c,d){return function(c,e,f){if(f)throw new Error("FireModelInstanceTest only accepts two arguments now.");this._map=c||null,this._changes={},this.toJSON=function(){return{_map:this._map,_path:e}},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null;var g=this;if(Object.defineProperty(this,"id",{get:function(){return"undefined"!=typeof g._changes.id?g._changes.id:g._map.id},set:function(a){g._changes.id=a}}),Object.defineProperty(this,"name",{get:function(){return"undefined"!=typeof g._changes.name?g._changes.name:g._map.name},set:function(a){g._changes.name=a}}),"undefined"!=typeof c.sessions&&null!==c.sessions)if(Array.isArray(c.sessions))c.sessions=c.sessions.map(function(a){var b=d.get("FireModelInstanceTestSession");return a._map?new b(a._map,e+"/sessions"):new b(a,e+"/sessions")});else{var h=d.get("FireModelInstanceTestSession");c.sessions=c.sessions._map?new h(c.sessions._map,e+"/sessions"):new h(c.sessions,e+"/sessions")}if(Object.defineProperty(this,"sessions",{get:function(){return"undefined"!=typeof g._changes.sessions?g._changes.sessions:g._map.sessions},set:function(a){g._changes.sessions=a}}),"undefined"!=typeof c.variants&&null!==c.variants)if(Array.isArray(c.variants))c.variants=c.variants.map(function(a){var b=d.get("FireModelInstanceTestVariant");return a._map?new b(a._map,e+"/variants"):new b(a,e+"/variants")});else{var h=d.get("FireModelInstanceTestVariant");c.variants=c.variants._map?new h(c.variants._map,e+"/variants"):new h(c.variants,e+"/variants")}Object.defineProperty(this,"variants",{get:function(){return"undefined"!=typeof g._changes.variants?g._changes.variants:g._map.variants},set:function(a){g._changes.variants=a}}),this.cancel=function(){this._changes={}},this.refresh=function(b){return this._map=b._map,this._changes={},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null,this},this.toQueryValue=function(){return this._map.id},this.remove=function(){return a.remove(this._map.id)},this.save=function(){if(null===this._map)return a.create(this._changes).then(function(a){return g.refresh(a)});var c=Object.keys(this._changes).length;if(c){var d=transformQueryMap(this._changes);return a._put(this._endpoint,d).then(function(a){return g._changes={},Object.keys(a._map).forEach(function(b){null!==a._map[b]&&(g._map[b]=a._map[b])}),g})}return b.when(this)},this.getSessions=function(b,c){return d.get("TestSessionModel")._find(a.endpoint+"/"+this.id+"/sessions",b,c).then(function(a){return g.sessions=a,a})},this.createSession=function(b){return d.get("TestSessionModel")._create(a.endpoint+"/"+this.id+"/sessions",b).then(function(a){return g.sessions||(g.sessions=[]),g.sessions.push(a),a})},this.removeSession=function(b){var c=_getUUID(b);return d.get("TestSessionModel")._action("delete",a.endpoint+"/"+this.id+"/sessions/"+c).then(function(a){for(var b=0,d=g.sessions.length;d>b;b++){var e=g.sessions[b];if(e.id===c){g.sessions.splice(b,1);break}}return a})},this.removeSessions=function(b){return d.get("TestSessionModel")._action("delete",a.endpoint+"/"+this.id+"/sessions",a._prepare(transformQueryMap(b))).then(function(a){var b=a.map(function(a){return a.id});return g.sessions=g.sessions.filter(function(a){return-1===b.indexOf(a.id)}),a})},this.updateSessions=function(b,c){return d.get("TestSessionModel")._put(a.endpoint+"/"+this.id+"/sessions",transformQueryMap(c),transformQueryMap(b)).then(function(a){for(var b=0,c=a.length;c>b;b++)for(var d=a[b],e=0,f=g.sessions.length;f>e;e++){var h=g.sessions[e];if(h.id==d.id){Object.keys(d._map).forEach(function(a){null!==d._map[a]&&(h._map[a]=d._map[a])});break}}})},this.getVariants=function(b,c){return d.get("TestVariantModel")._find(a.endpoint+"/"+this.id+"/variants",b,c).then(function(a){return g.variants=a,a})},this.createVariant=function(b){return d.get("TestVariantModel")._create(a.endpoint+"/"+this.id+"/variants",b).then(function(a){return g.variants||(g.variants=[]),g.variants.push(a),a})},this.removeVariant=function(b){var c=_getUUID(b);return d.get("TestVariantModel")._action("delete",a.endpoint+"/"+this.id+"/variants/"+c).then(function(a){for(var b=0,d=g.variants.length;d>b;b++){var e=g.variants[b];if(e.id===c){g.variants.splice(b,1);break}}return a})},this.removeVariants=function(b){return d.get("TestVariantModel")._action("delete",a.endpoint+"/"+this.id+"/variants",a._prepare(transformQueryMap(b))).then(function(a){var b=a.map(function(a){return a.id});return g.variants=g.variants.filter(function(a){return-1===b.indexOf(a.id)}),a})},this.updateVariants=function(b,c){return d.get("TestVariantModel")._put(a.endpoint+"/"+this.id+"/variants",transformQueryMap(c),transformQueryMap(b)).then(function(a){for(var b=0,c=a.length;c>b;b++)for(var d=a[b],e=0,f=g.variants.length;f>e;e++){var h=g.variants[e];if(h.id==d.id){Object.keys(d._map).forEach(function(a){null!==d._map[a]&&(h._map[a]=d._map[a])});break}}})}}}]),app.factory("TestParticipantModel",["$http","$q","FireModel","$injector","$route","$routeParams","$location",function(a,b,c){var d=new c("TestParticipant",[],"/api/test-participants");return d}]),app.factory("FireModelInstanceTestParticipant",["TestParticipantModel","$q","$http","$injector",function(a,b,c,d){return function(c,e,f){if(f)throw new Error("FireModelInstanceTestParticipant only accepts two arguments now.");this._map=c||null,this._changes={},this.toJSON=function(){return{_map:this._map,_path:e}},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null;var g=this;if(Object.defineProperty(this,"id",{get:function(){return"undefined"!=typeof g._changes.id?g._changes.id:g._map.id},set:function(a){g._changes.id=a}}),"undefined"!=typeof c.sessions&&null!==c.sessions)if(Array.isArray(c.sessions))c.sessions=c.sessions.map(function(a){var b=d.get("FireModelInstanceTestSession");return a._map?new b(a._map,e+"/sessions"):new b(a,e+"/sessions")});else{var h=d.get("FireModelInstanceTestSession");c.sessions=c.sessions._map?new h(c.sessions._map,e+"/sessions"):new h(c.sessions,e+"/sessions")}Object.defineProperty(this,"sessions",{get:function(){return"undefined"!=typeof g._changes.sessions?g._changes.sessions:g._map.sessions},set:function(a){g._changes.sessions=a}}),this.cancel=function(){this._changes={}},this.refresh=function(b){return this._map=b._map,this._changes={},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null,this},this.toQueryValue=function(){return this._map.id},this.remove=function(){return a.remove(this._map.id)},this.save=function(){if(null===this._map)return a.create(this._changes).then(function(a){return g.refresh(a)});var c=Object.keys(this._changes).length;if(c){var d=transformQueryMap(this._changes);return a._put(this._endpoint,d).then(function(a){return g._changes={},Object.keys(a._map).forEach(function(b){null!==a._map[b]&&(g._map[b]=a._map[b])}),g})}return b.when(this)},this.getSessions=function(b,c){return d.get("TestSessionModel")._find(a.endpoint+"/"+this.id+"/sessions",b,c).then(function(a){return g.sessions=a,a})},this.createSession=function(b){return d.get("TestSessionModel")._create(a.endpoint+"/"+this.id+"/sessions",b).then(function(a){return g.sessions||(g.sessions=[]),g.sessions.push(a),a})},this.removeSession=function(b){var c=_getUUID(b);return d.get("TestSessionModel")._action("delete",a.endpoint+"/"+this.id+"/sessions/"+c).then(function(a){for(var b=0,d=g.sessions.length;d>b;b++){var e=g.sessions[b];if(e.id===c){g.sessions.splice(b,1);break}}return a})},this.removeSessions=function(b){return d.get("TestSessionModel")._action("delete",a.endpoint+"/"+this.id+"/sessions",a._prepare(transformQueryMap(b))).then(function(a){var b=a.map(function(a){return a.id});return g.sessions=g.sessions.filter(function(a){return-1===b.indexOf(a.id)}),a})},this.updateSessions=function(b,c){return d.get("TestSessionModel")._put(a.endpoint+"/"+this.id+"/sessions",transformQueryMap(c),transformQueryMap(b)).then(function(a){for(var b=0,c=a.length;c>b;b++)for(var d=a[b],e=0,f=g.sessions.length;f>e;e++){var h=g.sessions[e];if(h.id==d.id){Object.keys(d._map).forEach(function(a){null!==d._map[a]&&(h._map[a]=d._map[a])});break}}})}}}]),app.factory("TestSessionModel",["$http","$q","FireModel","$injector","$route","$routeParams","$location",function(a,b,c){var d=new c("TestSession",[],"/api/test-sessions");return d}]),app.factory("FireModelInstanceTestSession",["TestSessionModel","$q","$http","$injector",function(a,b,c,d){return function(c,e,f){if(f)throw new Error("FireModelInstanceTestSession only accepts two arguments now.");this._map=c||null,this._changes={},this.toJSON=function(){return{_map:this._map,_path:e}},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null;var g=this;if(Object.defineProperty(this,"id",{get:function(){return"undefined"!=typeof g._changes.id?g._changes.id:g._map.id},set:function(a){g._changes.id=a}}),"undefined"!=typeof c.test&&null!==c.test)if(Array.isArray(c.test))c.test=c.test.map(function(a){var b=d.get("FireModelInstanceTest");return a._map?new b(a._map,e+"/tests"):new b(a,e+"/tests")});else{var h=d.get("FireModelInstanceTest");c.test=c.test._map?new h(c.test._map,e+"/tests"):new h(c.test,e+"/tests")}if(Object.defineProperty(this,"test",{get:function(){return"undefined"!=typeof g._changes.test?g._changes.test:g._map.test},set:function(a){g._changes.test=a}}),"undefined"!=typeof c.participant&&null!==c.participant)if(Array.isArray(c.participant))c.participant=c.participant.map(function(a){var b=d.get("FireModelInstanceTestParticipant");return a._map?new b(a._map,e+"/participants"):new b(a,e+"/participants")});else{var h=d.get("FireModelInstanceTestParticipant");c.participant=c.participant._map?new h(c.participant._map,e+"/participants"):new h(c.participant,e+"/participants")}Object.defineProperty(this,"participant",{get:function(){return"undefined"!=typeof g._changes.participant?g._changes.participant:g._map.participant},set:function(a){g._changes.participant=a}}),Object.defineProperty(this,"variant",{get:function(){return"undefined"!=typeof g._changes.variant?g._changes.variant:g._map.variant},set:function(a){g._changes.variant=a}}),Object.defineProperty(this,"createdAt",{get:function(){return"undefined"!=typeof g._changes.createdAt?g._changes.createdAt:g._map.createdAt},set:function(a){g._changes.createdAt=a}}),c.createdAt&&(c.createdAt=new Date(c.createdAt)),this.cancel=function(){this._changes={}},this.refresh=function(b){return this._map=b._map,this._changes={},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null,this},this.toQueryValue=function(){return this._map.id},this.remove=function(){return a.remove(this._map.id)},this.save=function(){if(null===this._map)return a.create(this._changes).then(function(a){return g.refresh(a)});var c=Object.keys(this._changes).length;if(c){var d=transformQueryMap(this._changes);return a._put(this._endpoint,d).then(function(a){return g._changes={},Object.keys(a._map).forEach(function(b){null!==a._map[b]&&(g._map[b]=a._map[b])}),g})}return b.when(this)},this.getTest=function(){console.log("Warning: getTest is deprecated. Please use get instead.")},this.createTest=function(){console.log("Warning: createTest is deprecated. Please use create instead.")},this.removeTest=function(){console.log("Warning: removeTest is deprecated. Please use remove instead.")},this.getTest=function(b,c){return d.get("TestModel")._find(a.endpoint+"/"+this.id+"/test",b,c).then(function(a){return a?(a&&(a._endpoint=d.get("TestModel").endpoint+"/"+a.id),g.test=a,a):null})},this.createTest=function(b){return d.get("TestModel")._create(a.endpoint+"/"+this.id+"/test",b).then(function(a){return g.test=a,a})},this.removeTest=function(){return d.get("TestModel")._action("delete",a.endpoint+"/"+this.id+"/test").then(function(a){return g.test=null,a})},this.getParticipant=function(){console.log("Warning: getParticipant is deprecated. Please use get instead.")},this.createParticipant=function(){console.log("Warning: createParticipant is deprecated. Please use create instead.")},this.removeParticipant=function(){console.log("Warning: removeParticipant is deprecated. Please use remove instead.")},this.getParticipant=function(b,c){return d.get("TestParticipantModel")._find(a.endpoint+"/"+this.id+"/participant",b,c).then(function(a){return a?(a&&(a._endpoint=d.get("TestParticipantModel").endpoint+"/"+a.id),g.participant=a,a):null})},this.createParticipant=function(b){return d.get("TestParticipantModel")._create(a.endpoint+"/"+this.id+"/participant",b).then(function(a){return g.participant=a,a})},this.removeParticipant=function(){return d.get("TestParticipantModel")._action("delete",a.endpoint+"/"+this.id+"/participant").then(function(a){return g.participant=null,a})}}}]),app.factory("TestVariantModel",["$http","$q","FireModel","$injector","$route","$routeParams","$location",function(a,b,c){var d=new c("TestVariant",[],"/api/test-variants");return d}]),app.factory("FireModelInstanceTestVariant",["TestVariantModel","$q","$http","$injector",function(a,b,c,d){return function(c,e,f){if(f)throw new Error("FireModelInstanceTestVariant only accepts two arguments now.");this._map=c||null,this._changes={},this.toJSON=function(){return{_map:this._map,_path:e}},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null;var g=this;if(Object.defineProperty(this,"id",{get:function(){return"undefined"!=typeof g._changes.id?g._changes.id:g._map.id},set:function(a){g._changes.id=a}}),Object.defineProperty(this,"name",{get:function(){return"undefined"!=typeof g._changes.name?g._changes.name:g._map.name},set:function(a){g._changes.name=a}}),Object.defineProperty(this,"numberOfParticipants",{get:function(){return"undefined"!=typeof g._changes.numberOfParticipants?g._changes.numberOfParticipants:g._map.numberOfParticipants},set:function(a){g._changes.numberOfParticipants=a}}),"undefined"!=typeof c.test&&null!==c.test)if(Array.isArray(c.test))c.test=c.test.map(function(a){var b=d.get("FireModelInstanceTest");return a._map?new b(a._map,e+"/tests"):new b(a,e+"/tests")});else{var h=d.get("FireModelInstanceTest");c.test=c.test._map?new h(c.test._map,e+"/tests"):new h(c.test,e+"/tests")}Object.defineProperty(this,"test",{get:function(){return"undefined"!=typeof g._changes.test?g._changes.test:g._map.test},set:function(a){g._changes.test=a}}),this.cancel=function(){this._changes={}},this.refresh=function(b){return this._map=b._map,this._changes={},this._endpoint=this._map.id?a.endpoint+"/"+this._map.id:null,this},this.toQueryValue=function(){return this._map.id},this.remove=function(){return a.remove(this._map.id)},this.save=function(){if(null===this._map)return a.create(this._changes).then(function(a){return g.refresh(a)});var c=Object.keys(this._changes).length;if(c){var d=transformQueryMap(this._changes);return a._put(this._endpoint,d).then(function(a){return g._changes={},Object.keys(a._map).forEach(function(b){null!==a._map[b]&&(g._map[b]=a._map[b])}),g})}return b.when(this)},this.getTest=function(){console.log("Warning: getTest is deprecated. Please use get instead.")},this.createTest=function(){console.log("Warning: createTest is deprecated. Please use create instead.")},this.removeTest=function(){console.log("Warning: removeTest is deprecated. Please use remove instead.")},this.getTest=function(b,c){return d.get("TestModel")._find(a.endpoint+"/"+this.id+"/test",b,c).then(function(a){return a?(a&&(a._endpoint=d.get("TestModel").endpoint+"/"+a.id),g.test=a,a):null})},this.createTest=function(b){return d.get("TestModel")._create(a.endpoint+"/"+this.id+"/test",b).then(function(a){return g.test=a,a})},this.removeTest=function(){return d.get("TestModel")._action("delete",a.endpoint+"/"+this.id+"/test").then(function(a){return g.test=null,a})}}}]),app.service("fire",[function(){function a(a,b){var c=b;return a.then(function(a){angular.copy(a,c)}),c}this.unwrap=a,this.isServer=function(){return!1},this.isClient=function(){return!0}}]),app.config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode({enabled:!0,requireBase:!1}),a.when("/",{templateUrl:"/templates/test.html",controller:"TestController",resolve:{}})}]),app.service("_StorageService",[function(){var a={};this.get=function(b){return"undefined"!=typeof a[b]?a[b]:window.localStorage.getItem(b)},this.set=function(b,c){try{window.localStorage.setItem(b,c)}catch(d){a[b]=c}},this.unset=function(b){"undefined"!=typeof a[b]?delete a[b]:window.localStorage.removeItem(b)}}]),app.provider("TestsService",[function(){var a=null;this.delegate=function(b){a=b},this.$get=function(){return{participate:function(b,c){if(null===a)throw new Error("Please set the TestsService.delegate");if("function"!=typeof a)throw new Error("TestsService#delegate must be a function.");a(b,c)}}}}]);
//# sourceMappingURL=fire.min.js.map