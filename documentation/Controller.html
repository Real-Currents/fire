<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>Documentation Class: Controller - Node on Fire</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="/styles/default.css"/>
</head>

<body>
	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="col-md-8 col-md-offset-2">
				<ul class="nav navbar-nav">
					<li><a href="/">Home</a></li>
					<li><a href="/getting-started">Getting Started</a></li>
					<li class="active"><a href="/documentation">Documentation</a></li>
					<li><a href="/examples">Examples</a></li>
					<li><a href="/tutorials">Tutorials</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container-fluid">
		<div class="row">
			<div class="col-md-offset-1 col-md-3">
				
				<div id="toc"></div>
				
			</div>

			<div id="main" class="col-md-7">
				


	<h1 class="page-title">Class: Controller</h1>
<section>

<header>
    <h2>
    Controller
    </h2>
    
</header>

<article>
    <div class="container-overview">
    

    
        
<dt>
    <h4 class="name" id="Controller"><span class="type-signature"></span>new Controller<span class="signature">(models, request, response)</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>The base constructor of a controller. Inheritance is applied when calling <a href="App.html#controller">App#controller</a> on a controller constructor. Do not call this constructor yourself (unless you know what you are doing).</p>
<p>To prevent leaking of data between requests, for every request a new instance is allocated and initialized. This is likely to change in the future because of optimizations.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>models</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Models</span>



            
            </td>

            

            

            <td class="description last"><p>The models module.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">http.IncomingMessage</span>



            
            </td>

            

            

            <td class="description last"><p>The HTTP request from express.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>response</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">http.ServerResponse</span>



            
            </td>

            

            

            <td class="description last"><p>The HTTP response from express.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	<h5 class="subsection-title">Properties:</h5>

	<dl>

<table class="props table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>basePathComponents</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Array</span>



            
            </td>

            

            

            <td class="description last"><p>The base path or prefix of every route in this controller. A <code>basePathComponents</code> of <code>['api', 'v1']</code> would prefix every route with <code>/api/v1</code>.</p>
<p>The below example creates a controller which returns all users when calling <code>/api/v1/users</code>.</p>
<pre class="prettyprint source lang-js"><code>function MyController() {
    // This is executed in the local context.
}
app.controller(MyController);

MyController.prototype.basePathComponents = ['api', 'v1'];

MyController.prototype.getUsers = function() {
    return [];
};</code></pre></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>models</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Models</span>



            
            </td>

            

            

            <td class="description last"><p>The models instance. This exposes all models registered via <a href="App.html#model">App#model</a>.</p>
<p>In a controller method, in the server-context, you can access e.g. a <code>User</code> model via the following:</p>
<pre class="prettyprint source lang-js"><code>MyController.prototype.getUser = function($id) {
    return this.models.User.findOne({id: $id});
};</code></pre><p>In a controller, in the client-context, you can access the models via the <code>fire</code> service:</p>
<pre class="prettyprint source"><code>function MyController($scope, fire) {
    fire.models.User.findOne({name: 'Martijn'})
        .then(function(user) {
            // Do something with `user`.
        })
}
app.controller(MyController);</code></pre></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>session</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">express.cookie-session</span>



            
            </td>

            

            

            <td class="description last"><p>Cookie-based session storage. The session is initialized when a controller is constructed. The <code>SESSION_KEYS</code> environmental variable is used as keys to sign the cookie, see <a href="https://github.com/expressjs/cookie-session">https://github.com/expressjs/cookie-session</a> for more information.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>body</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Dictionary</span>



            
            </td>

            

            

            <td class="description last"><p>The HTTP request's body.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Dictionary</span>



            
            </td>

            

            

            <td class="description last"><p>The HTTP request's query parameters.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>__request</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">http.IncomingMessage</span>



            
            </td>

            

            

            <td class="description last"><p>The HTTP request.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>__response</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">http.ServerResponse</span>



            
            </td>

            

            

            <td class="description last"><p>The HTTP response.</p></td>
        </tr>

	
	</tbody>
</table>
</dl>

	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<dt>
    <h4 class="name" id="after"><span class="type-signature"></span>after<span class="signature">()</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>You may overwrite this method.</p>
<p>The after method is executed after any matching request is routed to the controller and is successful. You typically overwrite this method to perform any tasks after any requests matching the controller succeeded.</p>
<p>This method is executed after the response has been send to the client. It's not possible to change the response to the client from this method. This behaviour might change in the future.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="before"><span class="type-signature"></span>before<span class="signature">()</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>You may overwrite this method.</p>
<p>The before method is executed before any matching request is routed to the controller. You typically overwrite this method to perform any actions before any request is routed to the controller.</p>
<p>The below example creates a <code>before</code> method which gets executed before the <code>getTests</code> is executed:</p>
<pre class="prettyprint source"><code>function MyController() {
    // This is run in the client-context.
}
app.controller(MyController);

MyController.prototype.before = function() {
    // Do something before every method.
};

MyController.prototype.getTests = function() {
    return [];
};</code></pre><p>If you return a promise, the flow is only resumed when you resolve the promise. If you reject the promise, an error is returned.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="configure"><span class="type-signature"></span>configure<span class="signature">()</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This method is executed right after your controller gets allocated right before a request. The first parameter to this request is the value of <code>process.env.NODE_ENV</code> or 'development'.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="findAuthenticator"><span class="type-signature"></span>findAuthenticator<span class="signature">()</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>This method returns the current authenticated authenticator instance, for example, the currently signed in user.</p>
<p>An authenticator is configured via the <a href="PropertyTypes.html#Authenticate">PropertyTypes#Authenticate</a> property type.</p>
<p>This method does not cache the return value.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="getRouter"><span class="type-signature"></span>getRouter<span class="signature">(controllerConstructor, filePath)</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Creates and returns a router. The router is responsible for creating the routes of the controller. For example, if you have a method named <code>getUser($id)</code> on your controller, the router creates the HTTP route to it, in the default router's case <code>GET /users/:id</code>.</p>
<p>If you want to override the default router behaviour of your controller(s), override this method and return a custom router. See <a href="Router.html">Router</a> for more information on how to override the router.</p>
<p>This method is not invoked on an instance, but rather, the method is retrieved from the controller constructor's prototype. <code>this</code> will be undefined when this method is invoked. Do not rely on it.</p>
    </div>
    

    
    
    
        <h5>This:</h5>
        <ul><li>undefined</li></ul>
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>controllerConstructor</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Constructor</span>



            
            </td>

            

            

            <td class="description last"><p>The controller's constructor. The default router loops over this constructor's prototype to build the  routes for every method.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>filePath</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">String</span>



            
            </td>

            

            

            <td class="description last"><p>The path to the controller's file. The default router sets Controller#basePathComponents based on subdirectories the controller's file is located in. For example, if your controller is saved in a file at <code>controllers/api/controller.js</code> the <code>basePathComponents</code> is set to <code>['api']</code>.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The newly created router.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="label label-primary param-type"><a href="Router.html">Router</a></span>



	</dd>
</dl>


        
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="param"><span class="type-signature"></span>param<span class="signature">(name)</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns the value of the request's route parameter, body or query. This is a convenience method. See <a href="http://expressjs.com/4x/api.html#req.param">http://expressjs.com/4x/api.html#req.param</a>.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">String</span>



            
            </td>

            

            

            <td class="description last"><p>The name of the parameter.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="label label-primary param-type">Mixed</span>



	</dd>
</dl>


        
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="template"><span class="type-signature"></span>template<span class="signature">(templateName, templateOptions)</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns a template to render. This should only be used in view routes.</p>
<p>A view route is created by prefixing the method name with <code>view</code>, like the below.</p>
<pre class="prettyprint source"><code>MyController.prototype.viewTest = function() {
    return this.template('user.jade');
};</code></pre><p>This creates a route in the local-context angular <code>$routeProvider</code>, creates a <code>templateUrl</code> to <code>GET /templates/user.jade</code> and makes sure direct access to <code>GET /test</code> also works. For more information on routes, see <a href="Router.html">Router</a>.</p>
<p>For more information on templates and how to declare them, see <a href="Templates.html">Templates</a>.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>templateName</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">String</span>



            
            </td>

            

            

            <td class="description last"><p>The name of the template, for example, index.jade.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>templateOptions</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">Dictionary</span>



            
            </td>

            

            

            <td class="description last"><p>Optionally any template options passed to the template renderer.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>The template.</p>
</div>



<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="label label-primary param-type">Template</span>



	</dd>
</dl>


        
    
    
</dd>

        </dl>
    

    

    
</article>

</section>




			</div>
		</div>

		<div class="row">
			<div class="col-md-offset-4 col-md-7">
				<p class="expl disqus-expl">Do you have any questions or comments on this page? Start a discussion below.</p>

			    <div id="disqus_thread"></div>
				<script type="text/javascript">
    			var disqus_shortname = 'nodeonfire';
    			(function() {
        			var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    			})();
				</script>
				<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
			</div>
		</div>

		<div class="row">
			<div class="col-md-offset-4 col-md-7">
				This is the footer.
			</div>
		</div>
	</div>

	<script src="/bower_components/jquery/dist/jquery.min.js"></script>
	<script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<script src="scripts/toc.js"></script>
	<script>
		$( function () {
			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "0px"
			} );

			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );
		} );
	 </script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-52717773-3', 'auto');
ga('send', 'pageview');
</script>

</body>
</html>