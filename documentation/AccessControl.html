<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>Documentation Class: AccessControl</title>
	<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css"/>
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<style>
	body {
		padding-top:50px;
	}
	.navbar {
		background:#fff;
	}
	.nav .toc-h1 {
		margin-top:20px;
	}
	.nav .toc-h1 a {
		color:rgb(51, 51, 51);
		font-weight:600;
		display:inline;
	}
	.nav .toc-h3 {
		margin-top:10px;
	}
	.nav .toc-h3 a {
		color:rgb(51, 51, 51);
		font-weight:500;
		display:inline;
	}
	.nav .toc-h3 a:hover, .nav .toc-h1 a:hover {
		background:none;
	}
	#toc.affix {
		position: static;
		width: auto;
		top: 0;
	}
	.label.label-primary a {
		color:#fff;
	}
	span.type-signature {
		/* I really dislike this bit */
		display:none;
	}
	</style>
</head>

<body>
	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="col-md-8 col-md-offset-2">
				<ul class="nav navbar-nav">
					<li><a href="/">Home</a></li>
					<li class="active"><a href="/documentation">Documentation</a></li>
					<li><a href="/examples">Examples</a></li>
					<li><a href="/tutorials">Tutorials</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container-fluid">
		<div class="row">
			<div class="col-md-offset-1 col-md-3">
				
				<a href="/documentation">Back to documentation</a>

				<div data-spy="affix" id="toc"></div>
				
			</div>

			<div id="main" class="col-md-7">
				


	<h1 class="page-title">Class: AccessControl</h1>
<section>

<header>
    <h2>
    AccessControl
    </h2>
    
</header>

<article>
    <div class="container-overview">
    

    
        
<dt>
    <h4 class="name" id="AccessControl"><span class="type-signature"></span>new AccessControl<span class="signature">()</span><span class="type-signature"></span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>AccessControl manages the permissions of the current authenticator (see Controller#findAuthenticator) in the model controllers generated by the API module.</p>
<p>You can set access control for create, read, update and delete actions on a model. For example, consider a User model and to control who may call POST /api/users to create a new user. The below example only allows admins to create new users:</p>
<pre class="prettyprint source lang-js"><code>function User() {
    this.email = [this.String, this.Authenticate];
    this.admin = [this.Boolean];
    this.accessControl = [this.Create(function(authenticator) {
        return (authenticator && authenticator.admin === true);
    })];
}
app.model(User);</code></pre><p>Please note the access control is only applied to the model controllers generated by the API. When calling any of the model methods directly no access control is applied. This is your responsibility.</p>
<p>You can also set a key path to define the access control. If the authenticator matches the given key path, an action is permitted. For example, the below example only allows the author of the post to update the post.</p>
<pre class="prettyprint source lang-js"><code>function Post() {
    this.title = [this.String];
    this.text = [this.String];
    this.author = [this.BelongsTo(this.models.User)];
    this.accessControl = [this.Update('author')];
}
app.model(Post);</code></pre><p>You can also set Update on a property to configure who is allowed to change a property's value. See also PropertyTypes#Create, PropertyTypes#Read, PropertyTypes#Update, PropertyTypes#Delete for more information.</p>
    </div>
    

    
    
    
    
    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<dt>
    <h4 class="name" id="canCreate"><span class="type-signature"></span>canCreate<span class="signature">(authenticator)</span><span class="type-signature"> &rarr; {Boolean}</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns true if authenticator can create the model the access control belongs to.</p>
<p>An example request in the model controllers would be:</p>
<p><code>POST /api/users</code></p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>authenticator</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type"><a href="ModelInstance.html">ModelInstance</a></span>



            
            </td>

            

            

            <td class="description last"><p>The current authenticated authenticator (user). Can be null.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="label label-primary param-type">Boolean</span>



	</dd>
</dl>


        
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="canRead"><span class="type-signature"></span>canRead<span class="signature">(authenticator)</span><span class="type-signature"> &rarr; {Boolean}</span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns true if authenticator can read the model the access control belongs to.</p>
<p>An example request in the model controllers would be:</p>
<pre class="prettyprint source"><code>GET /api/users
GET /api/users/1</code></pre>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>authenticator</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type"><a href="ModelInstance.html">ModelInstance</a></span>



            
            </td>

            

            

            <td class="description last"><p>The current authenticated authenticator (user). Can be null.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    <h5>Returns:</h5>
    
            


<dl>
	<dt>
		Type
	</dt>
	<dd>
		
<span class="label label-primary param-type">Boolean</span>



	</dd>
</dl>


        
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="getPermissionFunction"><span class="type-signature"></span>getPermissionFunction<span class="signature">(action)</span><span class="type-signature"></span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns the permission function for a specific action. The permission function can be executed to determine whether permission is allowed for the given access.</p>
<p>In development mode, when no access control is set, this always allows all actions, but a warning is shown. In production mode, when no access control is set, the default behaviour is to always disallow any action.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>action</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">create</span>
|

<span class="label label-primary param-type">read</span>
|

<span class="label label-primary param-type">update</span>
|

<span class="label label-primary param-type">delete</span>



            
            </td>

            

            

            <td class="description last"><p>The action.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="getPermissionKeyPath"><span class="type-signature"></span>getPermissionKeyPath<span class="signature">(action)</span><span class="type-signature"></span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Returns the key path set for the given action, or null if a permission function is set. The system requesting the key path is responsbile for whether the key path matches the authenticated authenticator.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>action</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">create</span>
|

<span class="label label-primary param-type">read</span>
|

<span class="label label-primary param-type">update</span>
|

<span class="label label-primary param-type">delete</span>



            
            </td>

            

            

            <td class="description last"><p>The action.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="setPermissionFunction"><span class="type-signature"></span>setPermissionFunction<span class="signature">(action, permissionFunction)</span><span class="type-signature"></span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Sets a permission function for the given action. The permission function is executed to evaluate if the access control for action is allowed.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>action</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">create</span>
|

<span class="label label-primary param-type">read</span>
|

<span class="label label-primary param-type">update</span>
|

<span class="label label-primary param-type">delete</span>



            
            </td>

            

            

            <td class="description last"><p>The access controlled action.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>permissionFunction</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">function</span>



            
            </td>

            

            

            <td class="description last"><p>The function to allow or disallow the specific action. Returns truthy if allowed, and falsy if not allowed.</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        
            
<dt>
    <h4 class="name" id="setPermissionKeyPath"><span class="type-signature"></span>setPermissionKeyPath<span class="signature">(action, permissionKeyPath)</span><span class="type-signature"></span></h4>
    
    
</dt>
<dd>
    
    
    <div class="description">
        <p>Sets a key path to evaluate the access control. If the current authenticator matches the key path an action is allowed. Otherwise it's disallowed.</p>
<p>Key path-based access control currently only works in update actions.</p>
    </div>
    

    
    
    
    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
	<tr>
		
		<th>Name</th>
		

		<th>Type</th>

		

		

		<th class="last">Description</th>
	</tr>
	</thead>

	<tbody>
	

        <tr>
            
                <td class="name"><code>action</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">create</span>
|

<span class="label label-primary param-type">read</span>
|

<span class="label label-primary param-type">update</span>
|

<span class="label label-primary param-type">delete</span>



            
            </td>

            

            

            <td class="description last"><p>The action.</p></td>
        </tr>

	

        <tr>
            
                <td class="name"><code>permissionKeyPath</code></td>
            

            <td class="type">
            
                
<span class="label label-primary param-type">String</span>



            
            </td>

            

            

            <td class="description last"><p>A key path</p></td>
        </tr>

	
	</tbody>
</table>

    
    
    
<dl class="details">
	

	

	

	

	

	

	

	

	



	

	

	

	
</dl>

    
    

    

    
    
    
    
    
    
    
</dd>

        </dl>
    

    

    
</article>

</section>




			</div>
		</div>

		<div class="row">
			<div class="col-md-offset-4 col-md-7">
				This is the footer.
			</div>
		</div>
	</div>

	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "0px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-stacked" );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	

</body>
</html>